% Copyright note: This package defines titles
% Please check for updates
\ProvidesPackage{title-bakalavr}[2016/12/10 v.01]
\RequirePackage{xstring}
\RequirePackage{humans}
\RequirePackage{textcase} % \MakeTextUppercase{}
%% \RequirePackage{soul} % \ul for line-wrapping underline
\RequirePackage{setspace}

%% grade book number (зачётка)
\newcommand{\BAKgradebookNo}[1]{%
  \gdef\@BAKgradebookNo{#1}%
}
\BAKgradebookNo{xxxxx}

\newcommand*{\fordateq}[4]{%
  \notblank{#1}{\parbox[b]{0.3\textwidth}{#1}}{}%
  <<\underline{\notblank{#2}{\makebox[0.8cm][c]{\sl{#2}}}{\hspace{1cm}}}>> %
  \notblank{#3}{\underline{\makebox[2cm][c]{\sl{#3}}}}{\underline{\hspace{3cm}}} %
  20\underline{\notblank{#4}{\makebox[0.8cm][c]{\sl{#4}}}{\hspace{1cm}}}~г.%
}

\newcommand{\ChairFillingParagraph}[2]{
  #1 {\sl{#2}}
}

\newcommand{\ChairWorkDeadLine}[3]{%
  \gdef\@ChairWorkDeadLineDay{#1}%
  \gdef\@ChairWorkDeadLineMonth{#2}%
  \gdef\@ChairWorkDeadLineYear{#3}%
}
\ChairWorkDeadLine{}{}{}

\newcommand{\ChairWorkSigned}[3]{%
  \gdef\@ChairWorkSignedDay{#1}%
  \gdef\@ChairWorkSignedMonth{#2}%
  \gdef\@ChairWorkSignedYear{#3}%
}
\ChairWorkSigned{}{}{}
%% \newcommand{\BAKshortOrgPre}[1]{%
%%   \gdef\@BAKshortOrgPre{#1}%
%% }
%% \BAKshortOrgPre{common.tex/BAKshortOrg}

%% \newcommand{\BAKshortOrgDat}[1]{%
%%   \gdef\@BAKshortOrgDat{#1}%
%% }
%% \BAKshortOrgDat{common.tex/BAKshortDat}

\newcommand{\signature}[2]{%
  \parbox[b]{8cm}{#1}%
  \hfill\parbox{3cm}{\center\hrulefill}%
  \hfill\parbox[b]{5cm}{#2}%
}

\newcommand{\BAKprofessionCode}[1]{%
  \gdef\@BAKprofessionCode{#1}%
}
\BAKprofessionCode{ЭЭ}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\ChairHeaderName}[1]{%
  \gdef\@ChairHeaderName{#1}%
}
\ChairHeaderName{{\textbackslash}ChairHeaderName\{Полное наименование организации\}}

\newcommand{\ChairName}[1]{%
  \gdef\@ChairName{#1}%
}
\ChairName{{\textbackslash}ChairName\{Название кафедры\}}

\BAKhuman{author}{gen}{{\textbackslash}BAKhuman\{author\}\{gen\}\{Фамилия\}\{Инициалы\}\{Имя-отчество
  (с учетом падежа)\}\{Регалии\}}{}{}{}

\newcommand{\ChairTaskCourseWorkTitle}[1]{%
  \gdef\@ChairTaskCourseWorkTitle{#1}%
}
\ChairTaskCourseWorkTitle{{\textbackslash}ChairTaskCourseWorkTitle\{Тема работы\}}

\newcommand{\ChairTaskCourseWorkData}[1]{%
  \gdef\@ChairTaskCourseWorkData{#1}%
}
\ChairTaskCourseWorkData{{\textbackslash}ChairTaskCourseWorkData\{Данные к работе\}}

\newcommand{\ChairTaskCourseWorkContent}[1]{%
  \gdef\@ChairTaskCourseWorkContent{#1}%
}
\ChairTaskCourseWorkContent{{\textbackslash}ChairTaskCourseWorkContent\{Содержание без пунктов\}}

\newcommand{\ChairTaskCourseWorkGraphics}[1]{%
  \gdef\@ChairTaskCourseWorkGraphics{#1}%
}
\ChairTaskCourseWorkGraphics{{\textbackslash}ChairTaskCourseWorkGraphics\{Содержание графической части без пунктов\}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% company short name in column IX
\newcommand{\BAKcompanyIXfield}[1]{%
  \gdef\@BAKcompanyIXfield{#1}%
}

\newcommand{\BAKmakeCompany}{%
  \ESKDcolumnIX{\scriptsize{\@BAKcompanyIXfield, \ESKDtheYear, \@BAKgradebookNo, \@BAKprofessionCode}}
}

\newcommand{\BAKheadername}[1]{%
  \gdef\@BAKheadername{%
    \begin{center}%
      \parbox{0.8\textwidth}{\center{\fontsize{3.5mm}{3.5mm}\selectfont #1}}%
    \end{center}%
  }%
}

\BAKheadername{BAKheadername}

\newcommand{\BAKtitle}[1]{%
  \gdef\@BAKtitle{#1}%
  \ESKDtitle{#1}%
}

\newcommand{\BAKsetAuthor}[5]{%
  \BAKhuman{author}{#1}{#2}{#3}{#4}{#5}%
  \ESKDauthor{\BAKprintHuman{author}{nom}{surname}}%
}

\newcommand{\BAKsetAdviser}[5]{%
  \BAKhuman{adviser}{#1}{#2}{#3}{#4}{#5}%
  \ESKDchecker{\BAKprintHuman{adviser}{nom}{surname}}%
  \ESKDcolumnXIfIII{\BAKprintHuman{adviser}{nom}{surname}}% т. конт. ESKDcolumnXIfIII %
}
\BAKsetAdviser{nom}{BAKsetAdviser-nom}{F.}{Full}{regals}

\newcommand{\BAKsetNormContr}[5]{%
  \BAKhuman{normocontrol}{#1}{#2}{#3}{#4}{#5}%
  \ESKDnormContr{\BAKprintHuman{normocontrol}{nom}{surname}}%
}
\BAKsetNormContr{nom}{BAKsetNormContr-nom}{F.}{Full}{regals}

\newcommand{\BAKsetEconomist}[5]{%
  \BAKhuman{economist}{#1}{#2}{#3}{#4}{#5}%
}
%% \BAKsetEconomist{nom}{BAKsetEconomist-nom}{F.}{Full}{regals}
\BAKsetEconomist{nom}{Economist}{E.}{Full}{regals}

\newcommand{\BAKsetChairhead}[5]{%
  \BAKhuman{chairhead}{#1}{#2}{#3}{#4}{#5}%
  \ESKDapprovedBy{\BAKprintHuman{chairhead}{nom}{surname}}%
}
\BAKsetChairhead{nom}{BAKsetChairhead}{F.}{Full}{regals}

%% 1:day 2:month 3:year(2) 4:number
\newcommand{\BAKorderTheme}[4]{%
  \gdef\@BAKorderThemeDay{#1}%
  \gdef\@BAKorderThemeMonth{#2}%
  \gdef\@BAKorderThemeYear{#3}%
  \gdef\@BAKorderThemeCode{#4}%
}
\BAKorderTheme{}{}{}{}

\newcommand{\BAKworkDeadline}[3]{%
  \gdef\@BAKworkDeadlineDay{#1}%
  \gdef\@BAKworkDeadlineMonth{#2}%
  \gdef\@BAKworkDeadlineYear{#3}%
}
\BAKworkDeadline{}{}{}

\newlength{\listwidth}
\setlength{\listwidth}{5cm}


\newenvironment{listexplanation}[1][40mm]{%
  \let\olditem\item%
  \renewcommand{\item}[2]{%
    \olditem %
      \parbox[t][][t]{\listwidth}{##1}%
      \parbox[t][][t]{\textwidth-\listwidth}{##2}%
  }%
  \begin{list}{}{\setstretch{1.0}%
  \setlength{\parsep}{0pt}%
  \setlength{\topsep}{0pt}%
  \setlength{\itemsep}{3mm}%
  \setlength{\labelsep}{0pt}%
  \setlength{\listwidth}{#1}%
  \setlength{\leftmargin}{\listwidth}%
  \setlength{\itemindent}{-\listwidth}}}{%
  \end{list}
}

\newenvironment{signaturelist}{%
  \let\olditem\item%
  \renewcommand{\item}[2]{%
    \setstretch{1.0}
    \olditem \parbox[b]{0.5\textwidth-3cm}{##1}%
    \hfill\parbox[b]{4cm}{\hrulefill}%
    \hfill\parbox[b]{0.5\textwidth-3cm}{##2}%
  }%
  \begin{list}{}{%
  \setlength{\parsep}{0pt}%
  \setlength{\topsep}{0pt}%
  \setlength{\itemsep}{5mm}%
  \setlength{\labelsep}{0pt}%
  \setlength{\listwidth}{0pt}%
  \setlength{\leftmargin}{0pt}%
  \setlength{\itemindent}{0pt}}}{%
  \end{list}%
}

\newcommand*{\BAKfaculty}[1]{\gdef\@BAKfaculty{#1}}
\newcommand*{\@BAKfaculty}{BAKfaculty}

\newcommand*{\BAKchair}[1]{\gdef\@BAKchair{#1}}
\newcommand*{\@BAKchair}{BAKchair}

\newcommand*{\BAKworkType}[1]{\gdef\@BAKworkType{#1}}
\newcommand*{\@BAKworkType}{ВЫПУСКНАЯ КВАЛИФИКАЦИОННАЯ РАБОТА БАКАЛАВРА}

\newcommand*{\BAKworkSubType}[1]{\gdef\@BAKworkSubType{#1}}
\newcommand*{\@BAKworkSubType}{(расчётно-пояснительная записка)}

\newcommand*{\BAKworkPlace}[1]{\gdef\@BAKworkPlace{#1}}
\newcommand*{\@BAKworkPlace}{Зерноград}

\newcommand{\approvedstamp}{%
  \hfill \parbox[t][][t]{8cm}{%
    УТВЕРЖДАЮ \\
    Зав.~кафедрой \underline{\hspace{3cm}} \hfill \\
    \fordate%
  }%
}

% 1:stage 2:name 3:value 4:date
\newcommand*{\BAKcalendar}[4]{%
  \expandafter\gdef\csname @BAKcalendar#1Name\endcsname{#2}%
  \expandafter\gdef\csname @BAKcalendar#1Value\endcsname{#3}%
  \expandafter\gdef\csname @BAKcalendar#1Date\endcsname{#4}%
}
\BAKcalendar{I}{BAKcalendar I - II}{III}{IV}
\BAKcalendar{II}{BAKcalendar II - II}{III}{IV}
\BAKcalendar{III}{BAKcalendar III - II}{III}{IV}
\BAKcalendar{IV}{BAKcalendar IV - II}{III}{IV}

\newcommand*{\BAKdate}[4]{%
  \expandafter\gdef\csname @BAK#1day\endcsname{#2}%
  \expandafter\gdef\csname @BAK#1month\endcsname{#3}%
  \expandafter\gdef\csname @BAK#1year\endcsname{#4}%
}
\newcommand*{\BAKprintDate}[2]{
  \csname @BAK#1#2\endcsname%
}
\BAKdate{taskissued}{}{}{} %% задание выдано
\BAKdate{taskreceived}{}{}{} %% срок сдачи

\newcommand{\BAKsetSheet}[6]{%
  \expandafter\gdef\csname @BAKsheet#1suffix\endcsname{#2}%
  \expandafter\gdef\csname @BAKsheet#1nameI\endcsname{#3}%
  \expandafter\gdef\csname @BAKsheet#1nameII\endcsname{#4}%
  \expandafter\gdef\csname @BAKsheet#1nameIII\endcsname{#5}%
  \expandafter\gdef\csname @BAKsheet#1nameIV\endcsname{#6}%
}
\BAKsetSheet{I}{SufI}{BAKsetSheetI}{}{}{}
\BAKsetSheet{II}{SufII}{BAKsetSheetI}{BAKsetSheetII}{}{}
\BAKsetSheet{III}{SufIII}{BAKsetSheetI}{BAKsetSheetII}{BAKsetSheetIII}{}
\BAKsetSheet{IV}{SufIV}{BAKsetSheetI}{BAKsetSheetII}{BAKsetSheetIII}{BAKsetSheetIV}

\newcommand{\BAKsheetNameFull}[1]{%
  \csname @BAKsheet#1nameI\endcsname%
  \csname @BAKsheet#1nameII\endcsname%
  \csname @BAKsheet#1nameIII\endcsname%
  \csname @BAKsheet#1nameIV\endcsname%
}

\newcommand{\BAKsheetCode}[1]{%
  \BAKcode{\csname @BAKsheet#1suffix\endcsname}%
}

\newcommand*{\BAKsheetTabular}[1]{%
  A1 & & & \BAKsheetCode{#1} % code %
  & \csname @BAKsheet#1nameI\endcsname % name %
  \ifcsempty{@BAKsheet#1nameII}{& 1 \\}%
            {& \\ & & & & \csname @BAKsheet#1nameII\endcsname %
              \ifcsempty{@BAKsheet#1nameIII}{& 1 \\ }%
                        {& \\ & & & & \csname @BAKsheet#1nameIII\endcsname %
                          \ifcsempty{@BAKsheet#1nameIV}{& 1 \\ }%
                                    {& \\ & & & & \csname @BAKsheet#1nameIV\endcsname & 1 \\}}}%
}

%% \newcommand*{\BAKmaketitle}{%
%% \begin{ESKDtitlePage}
%% \ESKDstyle{empty}
%% \@BAKheadername
%% \vfill
%% \begin{listexplanation}
%%   \item{Факультет:}{\@BAKfaculty}
%%   \item{Кафедра:}{\@BAKchair}
%%   \item{Зав. кафедрой:}{\BAKprintHuman{chairhead}{nom}{regals}~\underline{\hskip 3cm}~\BAKprintHuman{chairhead}{nom}{short-pre}}
%% \end{listexplanation}
%% \vfill
%% \center{\@BAKworkType \\
%% \@BAKworkSubType}
%% \vfill
%% Тема: \ESKDtheTitle
%% \vfill
%% \begin{signaturelist}
%%   \item{Автор}{\BAKprintHuman{author}{nom}{short-pre}}
%%   \item{Руководитель}{\BAKprintHuman{adviser}{nom}{regals}\\ \BAKprintHuman{adviser}{nom}{short-pre}}
%%   \item{Н.~контроль}{\BAKprintHuman{normocontrol}{nom}{regals}\\ \BAKprintHuman{normocontrol}{nom}{short-pre}}
%%   \item{Консультант по экономической~части}{\BAKprintHuman{economist}{nom}{regals}\\ \BAKprintHuman{economist}{nom}{short-pre}}
%% \end{signaturelist}
%% \vfill
%% \center{\@BAKworkPlace~\ESKDtheYear}
%% \end{ESKDtitlePage}
%% }
\newcommand{\interskip}{\vskip 0.5cm plus 1cm minus 0.5cm}

\newcommand{\ChairMakeTaskCourseWork}{

\ESKDstyle{empty}

\begin{center}
  \@ChairHeaderName
\end{center}

\interskip

%% \hfill \parbox[t][][t]{10cm}{Кафедра: \@ChairName}%
\begin{listexplanation}
  \item{Кафедра:}{\@ChairName}
\end{listexplanation}

\interskip

%% \approvedstamp
%% {\setstretch{1.0}
\begin{center}
ЗАДАНИЕ НА КУРСОВУЮ РАБОТУ \\
\sl{\BAKprintHuman{author}{gen}{full-post}}
\end{center}

\interskip

\ChairFillingParagraph{1. Тема работы:}{<<\@ChairTaskCourseWorkTitle>>}
%% утверждена приказом по институту от
%% \fordateq{}{\@BAKorderThemeDay}{\@BAKorderThemeMonth}{\@BAKorderThemeYear}
%% \underline{\makebox[1.5cm][c]{\@BAKorderThemeCode}}

\interskip

2. Срок сдачи студентом завершённой работы
%% <<\@BAKworkDeadlineDay>> \@BAKworkDeadlineMonth{} 20\@BAKworkDeadlineYear{} г.
\fordateq{}{\@ChairWorkDeadLineDay}{\@ChairWorkDeadLineMonth}{\@ChairWorkDeadLineYear}

\interskip

\ChairFillingParagraph{3. Необходимые данные для выполнения работы: }{\@ChairTaskCourseWorkData}
%% 3. Исходные данные к работе выданы.
%% \newpage

\interskip

\ChairFillingParagraph{4. Содержание расчетно-пояснительной записки (перечень вопросов для разработки):}{\@ChairTaskCourseWorkContent}

%% \ChairFillingParagraph{5. Содержание графического материала (блок-схемы, чертежи, графики, диаграммы):}{\@ChairTaskCourseWorkContent}

\interskip

5. Дата выдачи задания
%% <<\@BAKworkDeadlineDay>> \@BAKworkDeadlineMonth{} 20\@BAKworkDeadlineYear{} г.
\fordateq{}{\@ChairWorkSignedDay}{\@ChairWorkSignedMonth}{\@ChairWorkSignedYear}

\interskip

\signature{Руководитель}{\BAKprintHuman{adviser}{nom}{short-pre}}

\signature{Задание принял к исполнению}{\BAKprintHuman{author}{nom}{short-pre}}

\vskip 0pt plus 1fil

%% 4. Содержание расчётно-пояснительной записки (перечень вопросов, подлежащих разработке):
%% \begin{enumerate}[label=\arabic*)]
%% \item \@BAKcalendarIName
%% \item \@BAKcalendarIIName
%% \item \@BAKcalendarIIIName
%% \item \@BAKcalendarIVName
%% \end{enumerate}
%% \vfill

%% 5. Перечень графического материала (с точным указанием обязательных чертежей):
%% \begin{enumerate}[label=\arabic*)]
%% \item \BAKsheetNameFull{I}
%% \item \BAKsheetNameFull{II}
%% \item \BAKsheetNameFull{III}
%% \item \BAKsheetNameFull{IV}
%% %%\item пятый чертёж
%% %%\item шестой чертёж
%% %%\item экономическое обоснование
%% \end{enumerate}
%% \vfill

%% 6. Консультанты по работе

%%   \begin{tabular}{ |l|c|c|c| }
%%   \hline
%%   & & \multicolumn{2}{ c| }{Подпись, дата} \\
%%   \cline{3-4}
%%   Раздел & Консультант & \multicolumn{2}{ c| }{Задание} \\
%%   \cline{3-4}
%%   & & \parbox[c][][t]{4cm}{\center{выдал}} &
%%   \parbox[c][][t]{4cm}{\center{принял}} \\
%%   \hline
%%   Основная часть & \BAKprintHuman{adviser}{nom}{short-post} & & \\
%%   \hline
%%   %% БЖД & Кто-то & & \\
%%   %% \hline
%%   Экономика & \BAKprintHuman{economist}{nom}{short-post} & & \\
%%   \hline
%%   \end{tabular}
%% \vfill

%% 7. Календарный план выполнения выпускной квалификационной работы

%%   \begin{tabular}{| l | c | c | c |}
%%   \hline
%%   \parbox[t][][t]{6cm}{Наименование этапов выпускной квалификационной работы} &
%%   \parbox[t][][t]{2cm}{Объём раздела} &
%%   \parbox[t][][t]{3cm}{Сроки \\выполнения} &
%%   \parbox[t][][t]{3cm}{Отметка о выполнении} \\
%%   \hline
%%   \@BAKcalendarIName & \@BAKcalendarIValue & \@BAKcalendarIDate & \\
%%   \hline
%%   \@BAKcalendarIIName & \@BAKcalendarIIValue & \@BAKcalendarIIDate & \\
%%   \hline
%%   \@BAKcalendarIIIName & \@BAKcalendarIIIValue & \@BAKcalendarIIIDate & \\
%%   \hline
%%   \@BAKcalendarIVName & \@BAKcalendarIVValue & \@BAKcalendarIVDate & \\
%%   \hline
%%   \end{tabular}

%% \vfill

%% \fordateq{Дата выдачи задания}
%%          {\BAKprintDate{taskissued}{day}}
%%          {\BAKprintDate{taskissued}{month}}
%%          {\BAKprintDate{taskissued}{year}}

%% \signature{Руководитель}{\BAKprintHuman{adviser}{nom}{short-pre}}

%% \vspace{3mm}
%% \fordateq{Задание принято к исполнению}
%%          {\BAKprintDate{taskreceived}{day}}
%%          {\BAKprintDate{taskreceived}{month}}
%%          {\BAKprintDate{taskreceived}{year}}

%% \signature{Подпись студента}{~}
%%}
}
%% \newcommand{\BAKetique}{
%%   \newpage
%%   \ESKDthisStyle{empty}
%%   \section*{Заявление о соблюдении профессиональной этики
%%     при написании выпускной квалификационной работы бакалавра}
%%   \vskip 1.5cm
%%   Я, \BAKprintHuman{author}{nom}{short-post}, студент бакалавриата
%%   \@BAKshortOrgPre{}, заявляю, что в моей бакалаврской работе на тему:
%%   <<\ESKDtheTitle>> представленной в Государственную экзаменационную
%%   комиссию для публичной защиты, соблюдены правила профессиональной
%%   этики, не допускающие наличия плагиата, фальсификации данных и
%%   ложного цитирования при написании выпускных квалификационных работ.

%%   Я ознакомлен с Положением о выпускной квалификационной работе
%%   бакалавра, действующим в \@BAKshortOrgDat{}, согласно которому
%%   обнаружение плагиата, фальсификации данных и ложного цитирования
%%   является основанием для снижения оценки за выпускную
%%   квалификационную работу, вплоть до выставления оценки
%%   <<неудовлетворительно>>.

%%   \hfil \underline{\hspace{3cm}} \hfil
%%   \BAKprintHuman{author}{nom}{short-pre}
%% }

\endinput
